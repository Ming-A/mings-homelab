global:
  enabled: true

server:
  ha:
    enabled: true
    replicas: 3
    raft:
      enabled: true
    antiAffinity: required
  
  ui:
    enabled: true

  readinessProbe:
    enabled: true
    path: '/v1/sys/health?standbyok=true&sealedcode=204&uninitcode=204'
  
  config: |
    ui = true
    
    listener "tcp" {
      tls_disable = 1
      address = "[::]:8200"
      cluster_address = "[::]:8201"
    }
    
    storage "raft" {
      path = "/openbao/data"
      node_id = "openbao-${POD_NAME}"
      
      retry_join {
        leader_api_addr = "http://openbao-0.openbao-internal.openbao.svc.cluster.local:8200"
      }
      retry_join {
        leader_api_addr = "http://openbao-1.openbao-internal.openbao.svc.cluster.local:8200"
      }
      retry_join {
        leader_api_addr = "http://openbao-2.openbao-internal.openbao.svc.cluster.local:8200"
      }
    }
    
    service_registration "kubernetes" {}

dev:
  enabled: false
